<!DOCTYPE html >
<html>
        <head>
          <title>borderpatrol - com.lookout.borderpatrol</title>
          <meta name="description" content="borderpatrol - com.lookout.borderpatrol" />
          <meta name="keywords" content="borderpatrol com.lookout.borderpatrol" />
          <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
          
      <link href="../../../lib/template.css" media="screen" type="text/css" rel="stylesheet" />
      <link href="../../../lib/diagrams.css" media="screen" type="text/css" rel="stylesheet" id="diagrams-css" />
      <script type="text/javascript" src="../../../lib/jquery.js" id="jquery-js"></script>
      <script type="text/javascript" src="../../../lib/jquery-ui.js"></script>
      <script type="text/javascript" src="../../../lib/template.js"></script>
      <script type="text/javascript" src="../../../lib/tools.tooltip.js"></script>
      
      <script type="text/javascript">
         if(top === self) {
            var url = '../../../index.html';
            var hash = 'com.lookout.borderpatrol.package';
            var anchor = window.location.hash;
            var anchor_opt = '';
            if (anchor.length >= 1)
              anchor_opt = '@' + anchor.substring(1);
            window.location.href = url + '#' + hash + anchor_opt;
         }
   	  </script>
    
        </head>
        <body class="value">
      <div id="definition">
        <img alt="Package" src="../../../lib/package_big.png" />
        <p id="owner"><a href="../../package.html" class="extype" name="com">com</a>.<a href="../package.html" class="extype" name="com.lookout">lookout</a></p>
        <h1>borderpatrol</h1><span class="permalink">
      <a href="../../../index.html#com.lookout.borderpatrol.package" title="Permalink" target="_top">
        <img src="../../../lib/permalink.png" alt="Permalink" />
      </a>
    </span>
      </div>

      <h4 id="signature" class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">package</span>
      </span>
      <span class="symbol">
        <span class="name">borderpatrol</span>
      </span>
      </h4>
      
          <div id="comment" class="fullcommenttop"><div class="comment cmt"><p>This is the root package of borderpatrol-core which provides a functional approach to web sessions and
authentication built on top of <span class="extype" name="com.twitter.finagle">Finagle</span>. It contains two main packages:
<a href="sessionx/package.html" class="extype" name="com.lookout.borderpatrol.sessionx">com.lookout.borderpatrol.sessionx</a> and <a href="auth/package.html" class="extype" name="com.lookout.borderpatrol.auth">com.lookout.borderpatrol.auth</a> which contain types and functions to
interact with HTTP services.</p></div><div class="toggleContainer block">
          <span class="toggle">Linear Supertypes</span>
          <div class="superTypes hiddenContent"><span class="extype" name="scala.AnyRef">AnyRef</span>, <span class="extype" name="scala.Any">Any</span></div>
        </div></div>
        

      <div id="mbrsel">
        <div id="textfilter"><span class="pre"></span><span class="input"><input id="mbrsel-input" type="text" accesskey="/" /></span><span class="post"></span></div>
        <div id="order">
              <span class="filtertype">Ordering</span>
              <ol>
                
                <li class="alpha in"><span>Alphabetic</span></li>
                <li class="inherit out"><span>By inheritance</span></li>
              </ol>
            </div>
        <div id="ancestors">
                <span class="filtertype">Inherited<br />
                </span>
                <ol id="linearization">
                  <li class="in" name="com.lookout.borderpatrol"><span>borderpatrol</span></li><li class="in" name="scala.AnyRef"><span>AnyRef</span></li><li class="in" name="scala.Any"><span>Any</span></li>
                </ol>
              </div><div id="ancestors">
            <span class="filtertype"></span>
            <ol>
              <li class="hideall out"><span>Hide All</span></li>
              <li class="showall in"><span>Show all</span></li>
            </ol>
          </div>
        <div id="visbl">
            <span class="filtertype">Visibility</span>
            <ol><li class="public in"><span>Public</span></li><li class="all out"><span>All</span></li></ol>
          </div>
      </div>

      <div id="template">
        <div id="allMembers">
        

        <div id="types" class="types members">
              <h3>Type Members</h3>
              <ol><li name="com.lookout.borderpatrol.AnyOps" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="AnyOps[A]extendsAnyVal"></a>
      <a id="AnyOps[A]:AnyOps[A]"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier">implicit final </span>
        <span class="kind">class</span>
      </span>
      <span class="symbol">
        <a href="package$$AnyOps.html"><span class="name">AnyOps</span></a><span class="tparams">[<span name="A">A</span>]</span><span class="result"> extends <span class="extype" name="scala.AnyVal">AnyVal</span></span>
      </span>
      </h4><span class="permalink">
      <a href="../../../index.html#com.lookout.borderpatrol.package@AnyOps[A]extendsAnyVal" title="Permalink" target="_top">
        <img src="../../../lib/permalink.png" alt="Permalink" />
      </a>
    </span>
      <p class="shortcomment cmt">Wraps any object with a <code>toFuture</code> method
</p><div class="fullcomment"><div class="comment cmt"><p>Wraps any object with a <code>toFuture</code> method
</p></div><dl class="paramcmts block"><dt class="tparam">A</dt><dd class="cmt"><p>object type</p></dd></dl></div>
    </li><li name="com.lookout.borderpatrol.IdxByteSeqOps" visbl="pub" data-isabs="false" fullComment="no" group="Ungrouped">
      <a id="IdxByteSeqOpsextendsAnyVal"></a>
      <a id="IdxByteSeqOps:IdxByteSeqOps"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier">implicit final </span>
        <span class="kind">class</span>
      </span>
      <span class="symbol">
        <a href="package$$IdxByteSeqOps.html"><span class="name">IdxByteSeqOps</span></a><span class="result"> extends <span class="extype" name="scala.AnyVal">AnyVal</span></span>
      </span>
      </h4><span class="permalink">
      <a href="../../../index.html#com.lookout.borderpatrol.package@IdxByteSeqOpsextendsAnyVal" title="Permalink" target="_top">
        <img src="../../../lib/permalink.png" alt="Permalink" />
      </a>
    </span>
      
    </li><li name="com.lookout.borderpatrol.StringOps" visbl="pub" data-isabs="false" fullComment="no" group="Ungrouped">
      <a id="StringOpsextendsAnyVal"></a>
      <a id="StringOps:StringOps"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier">implicit final </span>
        <span class="kind">class</span>
      </span>
      <span class="symbol">
        <a href="package$$StringOps.html"><span class="name">StringOps</span></a><span class="result"> extends <span class="extype" name="scala.AnyVal">AnyVal</span></span>
      </span>
      </h4><span class="permalink">
      <a href="../../../index.html#com.lookout.borderpatrol.package@StringOpsextendsAnyVal" title="Permalink" target="_top">
        <img src="../../../lib/permalink.png" alt="Permalink" />
      </a>
    </span>
      
    </li><li name="com.lookout.borderpatrol.ThrowableOps" visbl="pub" data-isabs="false" fullComment="no" group="Ungrouped">
      <a id="ThrowableOpsextendsAnyVal"></a>
      <a id="ThrowableOps:ThrowableOps"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier">implicit final </span>
        <span class="kind">class</span>
      </span>
      <span class="symbol">
        <a href="package$$ThrowableOps.html"><span class="name">ThrowableOps</span></a><span class="result"> extends <span class="extype" name="scala.AnyVal">AnyVal</span></span>
      </span>
      </h4><span class="permalink">
      <a href="../../../index.html#com.lookout.borderpatrol.package@ThrowableOpsextendsAnyVal" title="Permalink" target="_top">
        <img src="../../../lib/permalink.png" alt="Permalink" />
      </a>
    </span>
      <p class="shortcomment cmt">Wraps any <code>Throwable</code> with a <code>toFutureException</code> method</p>
    </li></ol>
            </div>

        

        <div id="values" class="values members">
              <h3>Value Members</h3>
              <ol><li name="com.lookout.borderpatrol.auth" visbl="pub" data-isabs="false" fullComment="no" group="Ungrouped">
      <a id="auth"></a>
      <a id="auth:auth"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">package</span>
      </span>
      <span class="symbol">
        <a href="auth/package.html"><span class="name">auth</span></a>
      </span>
      </h4><span class="permalink">
      <a href="../../../index.html#com.lookout.borderpatrol.package@auth" title="Permalink" target="_top">
        <img src="../../../lib/permalink.png" alt="Permalink" />
      </a>
    </span>
      
    </li><li name="com.lookout.borderpatrol.crypto" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="crypto"></a>
      <a id="crypto:crypto"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">package</span>
      </span>
      <span class="symbol">
        <a href="crypto/package.html"><span class="name">crypto</span></a>
      </span>
      </h4><span class="permalink">
      <a href="../../../index.html#com.lookout.borderpatrol.package@crypto" title="Permalink" target="_top">
        <img src="../../../lib/permalink.png" alt="Permalink" />
      </a>
    </span>
      <p class="shortcomment cmt">The <code>crypto</code> module includes primitives for:</p><div class="fullcomment"><div class="comment cmt"><p>The <code>crypto</code> module includes primitives for:</p><ul><li>generating random data <a href="crypto/Generator.html" class="extype" name="com.lookout.borderpatrol.crypto.Generator">Generator</a></li><li>creating cryptographic signers <a href="crypto/Signer.html" class="extype" name="com.lookout.borderpatrol.crypto.Signer">Signer</a></li><li>an implementation of encryption for session data <a href="crypto/CryptKey.html" class="extype" name="com.lookout.borderpatrol.crypto.CryptKey">CryptKey</a></li><li>an encrypted session store <a href="crypto/EncryptedSessionStore.html" class="extype" name="com.lookout.borderpatrol.crypto.EncryptedSessionStore">EncryptedSessionStore</a></li></ul><p>It also includes Type Classes for interfacing with backends that would like to encrypt data at rest.
</p></div></div>
    </li><li name="com.lookout.borderpatrol.errors" visbl="pub" data-isabs="false" fullComment="no" group="Ungrouped">
      <a id="errors"></a>
      <a id="errors:errors"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">object</span>
      </span>
      <span class="symbol">
        <a href="package$$errors$.html"><span class="name">errors</span></a>
      </span>
      </h4><span class="permalink">
      <a href="../../../index.html#com.lookout.borderpatrol.package@errors" title="Permalink" target="_top">
        <img src="../../../lib/permalink.png" alt="Permalink" />
      </a>
    </span>
      
    </li><li name="com.lookout.borderpatrol.example" visbl="pub" data-isabs="false" fullComment="no" group="Ungrouped">
      <a id="example"></a>
      <a id="example:example"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">package</span>
      </span>
      <span class="symbol">
        <a href="example/package.html"><span class="name">example</span></a>
      </span>
      </h4><span class="permalink">
      <a href="../../../index.html#com.lookout.borderpatrol.package@example" title="Permalink" target="_top">
        <img src="../../../lib/permalink.png" alt="Permalink" />
      </a>
    </span>
      
    </li><li name="com.lookout.borderpatrol.request" visbl="pub" data-isabs="false" fullComment="no" group="Ungrouped">
      <a id="request"></a>
      <a id="request:request"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">object</span>
      </span>
      <span class="symbol">
        <a href="package$$request$.html"><span class="name">request</span></a>
      </span>
      </h4><span class="permalink">
      <a href="../../../index.html#com.lookout.borderpatrol.package@request" title="Permalink" target="_top">
        <img src="../../../lib/permalink.png" alt="Permalink" />
      </a>
    </span>
      
    </li><li name="com.lookout.borderpatrol.security" visbl="pub" data-isabs="false" fullComment="no" group="Ungrouped">
      <a id="security"></a>
      <a id="security:security"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">package</span>
      </span>
      <span class="symbol">
        <a href="security/package.html"><span class="name">security</span></a>
      </span>
      </h4><span class="permalink">
      <a href="../../../index.html#com.lookout.borderpatrol.package@security" title="Permalink" target="_top">
        <img src="../../../lib/permalink.png" alt="Permalink" />
      </a>
    </span>
      
    </li><li name="com.lookout.borderpatrol.server" visbl="pub" data-isabs="false" fullComment="no" group="Ungrouped">
      <a id="server"></a>
      <a id="server:server"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">package</span>
      </span>
      <span class="symbol">
        <a href="server/package.html"><span class="name">server</span></a>
      </span>
      </h4><span class="permalink">
      <a href="../../../index.html#com.lookout.borderpatrol.package@server" title="Permalink" target="_top">
        <img src="../../../lib/permalink.png" alt="Permalink" />
      </a>
    </span>
      
    </li><li name="com.lookout.borderpatrol.sessionx" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="sessionx"></a>
      <a id="sessionx:sessionx"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">package</span>
      </span>
      <span class="symbol">
        <a href="sessionx/package.html"><span class="name">sessionx</span></a>
      </span>
      </h4><span class="permalink">
      <a href="../../../index.html#com.lookout.borderpatrol.package@sessionx" title="Permalink" target="_top">
        <img src="../../../lib/permalink.png" alt="Permalink" />
      </a>
    </span>
      <p class="shortcomment cmt">This introduces types and functions that enable identifying, fetching, and storing web session data.</p><div class="fullcomment"><div class="comment cmt"><p>This introduces types and functions that enable identifying, fetching, and storing web session data. This
is accomplished by a set of types that will be used by consumers of this library: <code>Session</code>, <code>Store</code>, and <code>Secret</code>.</p><p>A <a href="sessionx/Secret.html" class="extype" name="com.lookout.borderpatrol.sessionx.Secret">Secret</a> is a cryptographically verifiable signing key used to sign a
<a href="sessionx/SessionId.html" class="extype" name="com.lookout.borderpatrol.sessionx.SessionId">SessionId</a>. Creating a <code>Secret</code> is simple. It defaults to expire at
<span class="extype" name="com.lookout.borderpatrol.sessionx.Secret.lifetime">Secret.lifetime</span></p><pre><span class="kw">val</span> secret = Secret() <span class="cmt">// default secret expiry</span>
<span class="kw">val</span> expiringSecret = Secret(Time.now)

<span class="kw">val</span> randomBytes = EntropyGenerator(<span class="num">16</span>) <span class="cmt">// 16 bytes of randomness</span>
<span class="kw">val</span> randomId = EntropyGenerator(<span class="num">1</span>).head <span class="cmt">// 1 byte of randomness for an id</span>
<span class="kw">val</span> expiry = Time.from(<span class="num">0</span>) <span class="cmt">// very expired</span>
<span class="kw">val</span> constructedSecret = Secret(randomId, randomBytes, expiry)
log(s<span class="lit">"secret has expired: ${constructedSecret.expired == true}"</span>)

<span class="kw">val</span> signedMsg = secret.sign(<span class="lit">"message to by signed"</span>.getBytes)</pre><p>A <a href="sessionx/SessionId.html" class="extype" name="com.lookout.borderpatrol.sessionx.SessionId">SessionId</a> is a cryptographically signed identifier for a
<a href="sessionx/Session.html" class="extype" name="com.lookout.borderpatrol.sessionx.Session">Session</a>, it consists of entropy, expiry, secret,and signature of those
items. This is meant to be used as the <span class="extype" name="com.twitter.finagle.httpx.Cookie">com.twitter.finagle.httpx.Cookie</span> value, so we provide serializing to
<span class="extype" name="String">String</span>.</p><pre><span class="kw">val</span> id: SessionId = Await.result(SessionId.next)
<span class="kw">val</span> cookieValue: <span class="std">String</span> = id.asBase64
SessionId.from[<span class="std">String</span>](cookieValue) == id</pre><p>A <a href="sessionx/Session.html" class="extype" name="com.lookout.borderpatrol.sessionx.Session">Session</a> is product type of a cryptographically verifiable
identifier <a href="sessionx/SessionId.html" class="extype" name="com.lookout.borderpatrol.sessionx.SessionId">SessionId</a> and an arbitrary data type
A<code>. The only requirement for a <a href="sessionx/SessionStore.html" class="extype" name="com.lookout.borderpatrol.sessionx.SessionStore">SessionStore</a>[B,M] to store/fetch
a </code>Session[A]<code> is that there be some implicit injective views from </code>A =&gt; B<code> and </code>B =&gt; Try[A]<code>.</code></p><p>We have provided default encodings for: <code>httpx.Request =&gt; Buf</code>, <code>String =&gt; Buf</code> and their injective views.</p><pre><span class="cmt">// set up secret/session stores</span>
<span class="kw">implicit</span> <span class="kw">val</span> secretStore = SecretStores.InMemorySecretStore(Secrets(Secret(), Secret()))
<span class="kw">val</span> sessionStore = SessionStore.InMemoryStore()

<span class="cmt">// create a Session[httpx.Request]</span>
<span class="kw">val</span> newSessionFuture = Session(Request(<span class="lit">"http://localhost/api/stuff"</span>)) <span class="cmt">// entropy is blocking on the JVM</span>
<span class="kw">val</span> newSession = Await.result(newSessionFuture)

<span class="cmt">// see if the session expired (checks the [[SessionId.expires]])</span>
log(s<span class="lit">"Session has expired? ${newSession.expired}"</span>)

<span class="cmt">// store the session and then fetch it</span>
sessionStore.update(newSession).onFailure(log)
sessionStore.get(newSession.id).onSuccess(s <span class="kw">=&gt;</span> s <span class="kw">match</span> {
  <span class="kw">case</span> <span class="std">Some</span>(s) <span class="kw">=&gt;</span> log(s<span class="lit">"Same session?: ${newSession == s}"</span>)
  <span class="kw">case</span> <span class="std">None</span> <span class="kw">=&gt;</span> log(<span class="lit">"hrm, where did the session go?"</span>)
})</pre><p>Let's say you have a <a href="sessionx/Session.html#data:A" class="extmbr" name="com.lookout.borderpatrol.sessionx.Session#data">Session.data</a> type that doesn't have the
injective that you need, that's OK!
Assuming you are storing it in memcached, which requires a type of <span class="extype" name="com.twitter.io.Buf">Buf</span> for the value:</p><pre><span class="kw">trait</span> Foo {
  <span class="kw">val</span> value: <span class="std">Int</span>
}

<span class="kw">implicit</span> <span class="kw">val</span> enc = SessionDataEncoder[Foo](
  foo <span class="kw">=&gt;</span> Buf.U32BE(toBytes.value),
  buf <span class="kw">=&gt;</span> <span class="kw">new</span> Foo { <span class="kw">override</span> <span class="kw">val</span> value = Buf.U32BE.unapply(b) }
)

<span class="kw">val</span> foo1 = <span class="kw">new</span> Foo { <span class="kw">override</span> <span class="kw">val</span> value = <span class="num">1</span> }
<span class="kw">val</span> fooSession = Session(foo1)
sessionStore.update(fooSession)</pre></div></div>
    </li><li name="com.lookout.borderpatrol.util" visbl="pub" data-isabs="false" fullComment="no" group="Ungrouped">
      <a id="util"></a>
      <a id="util:util"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">package</span>
      </span>
      <span class="symbol">
        <a href="util/package.html"><span class="name">util</span></a>
      </span>
      </h4><span class="permalink">
      <a href="../../../index.html#com.lookout.borderpatrol.package@util" title="Permalink" target="_top">
        <img src="../../../lib/permalink.png" alt="Permalink" />
      </a>
    </span>
      
    </li></ol>
            </div>

        

        
        </div>

        <div id="inheritedMembers">
        <div class="parent" name="scala.AnyRef">
              <h3>Inherited from <span class="extype" name="scala.AnyRef">AnyRef</span></h3>
            </div><div class="parent" name="scala.Any">
              <h3>Inherited from <span class="extype" name="scala.Any">Any</span></h3>
            </div>
        
        </div>

        <div id="groupedMembers">
        <div class="group" name="Ungrouped">
              <h3>Ungrouped</h3>
              
            </div>
        </div>

      </div>

      <div id="tooltip"></div>

      <div id="footer">  </div>


    </body>
      </html>
